{
	"exclude_payload_type": false,
	"exclude_c2_profiles": false,
	"exclude_documentation_payload": false,
	"exclude_documentation_c2": false,
	"exclude_agent_icons": false
}

$apiKey = "APIKEY" 

do {
    $email = Read-Host "Enter email to check"

    $headers = @{
        'hibp-api-key' = $apiKey
        'user-agent' = 'powershell'
    }

    $url = "https://haveibeenpwned.com/api/v3/breachedaccount/$email"

    Write-Host "Checking $email..."

    try {
        $response = Invoke-RestMethod -Uri $url -Headers $headers -Method Get
        Write-Host "Found in these breaches:"
        $response | ForEach-Object { Write-Host "- $($_.Name)" }
    }
    catch {
        Write-Host "Error checking email: $($_.Exception.Message)"
    }

    $continue = Read-Host "Would you like to search another email? (yes/no)"
} while ($continue.ToLower() -eq "yes" -or $continue.ToLower() -eq "y")

Write-Host "Thank you for using the HIBP checker!"
pause
